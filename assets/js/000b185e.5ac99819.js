"use strict";(self.webpackChunkmithril=self.webpackChunkmithril||[]).push([[60],{7275:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>r,contentTitle:()=>d,default:()=>m,frontMatter:()=>s,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"primeira-entrega/solucao/modelagem-db","title":"Modelagem do Banco de Dados","description":"&emsp; Este documento descreve a modelagem do banco de dados do sistema, que integra funcionalidades de carteira digital, infraestrutura P2P, avalia\xe7\xe3o de cr\xe9dito, investimentos, transa\xe7\xf5es via Stellar Blockchain, detec\xe7\xe3o de fraude, LGPD e chat de suporte. Ademais, a modelagem foi desenvolvida para garantir escalabilidade, integridade referencial, seguran\xe7a de dados e suporte a an\xe1lises avan\xe7adas via Machine Learning, mantendo ader\xeancia a normas regulat\xf3rias (LGPD, Banco Central e Open Finance).","source":"@site/docs/primeira-entrega/solucao/modelagem-db.md","sourceDirName":"primeira-entrega/solucao","slug":"/primeira-entrega/solucao/modelagem-db","permalink":"/Mithril/docs/primeira-entrega/solucao/modelagem-db","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/primeira-entrega/solucao/modelagem-db.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Modelagem do Banco de Dados"},"sidebar":"tutorialSidebar","previous":{"title":"Escopo","permalink":"/Mithril/docs/primeira-entrega/solucao/escopo"},"next":{"title":"Pol\xedtica de Privacidade do Sistema de Carteira Digital P2P","permalink":"/Mithril/docs/primeira-entrega/solucao/LGPD/"}}');var o=a(4848),t=a(8453);const s={sidebar_position:5,title:"Modelagem do Banco de Dados"},d=void 0,r={},u=[{value:"Objetivos",id:"objetivos",level:2},{value:"Estrutura do Banco",id:"estrutura-do-banco",level:2}];function c(n){const e={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.p,{children:"\u2003 Este documento descreve a modelagem do banco de dados do sistema, que integra funcionalidades de carteira digital, infraestrutura P2P, avalia\xe7\xe3o de cr\xe9dito, investimentos, transa\xe7\xf5es via Stellar Blockchain, detec\xe7\xe3o de fraude, LGPD e chat de suporte. Ademais, a modelagem foi desenvolvida para garantir escalabilidade, integridade referencial, seguran\xe7a de dados e suporte a an\xe1lises avan\xe7adas via Machine Learning, mantendo ader\xeancia a normas regulat\xf3rias (LGPD, Banco Central e Open Finance)."}),"\n",(0,o.jsx)(e.h2,{id:"objetivos",children:"Objetivos"}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Gest\xe3o de usu\xe1rios e autentica\xe7\xe3o"}),": controle de acesso, wallets Stellar, dispositivos e biometria."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Perfis e score de cr\xe9dito"}),": unificar dados internos, Serasa e Open Finance em um score consolidado."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Fluxo de cr\xe9dito e investimento P2P"}),": permitir solicita\xe7\xf5es de cr\xe9dito, ofertas de investimento, contratos e parcelas."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Integra\xe7\xe3o com Stellar e PIX"}),": garantir rastreabilidade das transa\xe7\xf5es financeiras."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Seguran\xe7a antifraude"}),": an\xe1lise em tempo real, alertas e bloqueios automatizados."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Atendimento e experi\xeancia do usu\xe1rio"}),": recomenda\xe7\xf5es personalizadas, chat e suporte integrado."]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Compliance regulat\xf3rio (LGPD)"}),": consentimentos expl\xedcitos e rastreamento de uso de dados."]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"estrutura-do-banco",children:"Estrutura do Banco"}),"\n",(0,o.jsx)(e.p,{children:"\u2003 A modelagem foi estruturada em um banco de dados relacional (PostgreSQL), utilizando UUIDs como identificadores prim\xe1rios para todas as entidades, al\xe9m de recursos como JSONB para flexibilidade de dados, enums para padroniza\xe7\xe3o de classifica\xe7\xf5es e tabelas de hist\xf3rico para rastreabilidade."}),"\n",(0,o.jsxs)(e.p,{children:["\u2003 O c\xf3digo abaixo representa um diagrama com a organiza\xe7\xe3o das entidades e seus relacionamentos principais. A visualiza\xe7\xe3o do diagrama est\xe1 dispon\xedvel ",(0,o.jsx)(e.a,{href:"https://www.mermaidchart.com/d/790a16d5-b2ad-446a-ab7e-109478876d87",children:"aqui"}),"."]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-mermaid",children:'erDiagram\n    %% Entidades de Usu\xe1rios e Autentica\xe7\xe3o\n    USUARIO {\n        uuid id PK\n        string cpf UK "CPF \xfanico"\n        string email UK\n        string nome_completo\n        string telefone\n        date data_nascimento\n        timestamp criado_em\n        timestamp atualizado_em\n        boolean ativo\n        timestamp ultimo_acesso\n    }\n\n    AUTENTICACAO {\n        uuid id PK\n        uuid usuario_id FK\n        string senha_hash\n        string biometria_token\n        string device_id\n        timestamp ultimo_login\n        int tentativas_falhas\n        boolean bloqueado\n        timestamp bloqueado_ate\n    }\n\n    STELLAR_WALLET {\n        uuid id PK\n        uuid usuario_id FK\n        string public_key UK "Stellar Public Address"\n        boolean principal\n        timestamp criado_em\n        boolean ativo\n        string wallet_type "HOT, COLD"\n    }\n\n    %% Entidades de Perfil e Score\n    PERFIL_INVESTIDOR {\n        uuid id PK\n        uuid usuario_id FK\n        decimal saldo_disponivel\n        decimal total_investido\n        decimal retorno_acumulado\n        enum perfil_risco "CONSERVADOR, MODERADO, ARROJADO"\n        jsonb preferencias\n        timestamp atualizado_em\n    }\n\n    PERFIL_TOMADOR {\n        uuid id PK\n        uuid usuario_id FK\n        decimal renda_mensal\n        enum ocupacao "EMPREGADO, AUTONOMO, EMPRESARIO, APOSENTADO"\n        string empresa\n        decimal limite_credito\n        decimal credito_utilizado\n        timestamp atualizado_em\n    }\n\n    SCORE_CREDITO {\n        uuid id PK\n        uuid usuario_id FK\n        int score_interno "0-1000"\n        int score_serasa\n        int score_open_finance\n        int score_consolidado\n        enum classificacao "EXCELENTE, BOM, REGULAR, RUIM"\n        jsonb detalhamento\n        timestamp calculado_em\n        timestamp valido_ate\n    }\n\n    HISTORICO_SCORE {\n        uuid id PK\n        uuid score_credito_id FK\n        int score_anterior\n        int score_novo\n        string motivo_alteracao\n        jsonb dados_calculo\n        timestamp registrado_em\n    }\n\n    %% Entidades de Cr\xe9dito e Investimento\n    SOLICITACAO_CREDITO {\n        uuid id PK\n        uuid tomador_id FK\n        decimal valor_solicitado\n        int prazo_meses\n        enum finalidade "PESSOAL, EDUCACAO, SAUDE, NEGOCIO, OUTROS"\n        string descricao\n        enum status "PENDENTE, ANALISE, APROVADO, REPROVADO, CANCELADO"\n        decimal taxa_juros_sugerida\n        jsonb analise_ia\n        timestamp solicitado_em\n        timestamp respondido_em\n    }\n\n    OFERTA_INVESTIMENTO {\n        uuid id PK\n        uuid solicitacao_credito_id FK\n        uuid investidor_id FK\n        decimal valor_ofertado\n        decimal taxa_juros_oferecida\n        enum status "PENDENTE, ACEITA, RECUSADA, EXPIRADA"\n        string mensagem\n        timestamp criado_em\n        timestamp expira_em\n        timestamp respondido_em\n    }\n\n    CONTRATO {\n        uuid id PK\n        uuid solicitacao_credito_id FK\n        uuid oferta_investimento_id FK\n        uuid tomador_id FK\n        uuid investidor_id FK\n        decimal valor_total\n        decimal taxa_juros\n        int prazo_meses\n        decimal valor_parcela\n        date data_primeiro_vencimento\n        enum status "ATIVO, QUITADO, INADIMPLENTE, CANCELADO"\n        string documento_hash "Hash do contrato"\n        string stellar_tx_id "ID da transa\xe7\xe3o Stellar"\n        timestamp assinado_em\n        timestamp criado_em\n    }\n\n    PARCELA {\n        uuid id PK\n        uuid contrato_id FK\n        int numero_parcela\n        decimal valor_principal\n        decimal valor_juros\n        decimal valor_total\n        date data_vencimento\n        date data_pagamento\n        enum status "PENDENTE, PAGO, ATRASADO, CANCELADO"\n        decimal multa\n        decimal juros_atraso\n        string stellar_tx_id\n        timestamp criado_em\n    }\n\n    %% Transa\xe7\xf5es Blockchain\n    TRANSACAO_STELLAR {\n        uuid id PK\n        string stellar_tx_hash UK\n        uuid usuario_origem_id FK\n        uuid usuario_destino_id FK\n        string conta_origem\n        string conta_destino\n        decimal valor\n        enum tipo "TRANSFERENCIA, PAGAMENTO_PARCELA, INVESTIMENTO, RESGATE"\n        enum status "PENDENTE, CONFIRMADA, FALHA"\n        jsonb metadados\n        timestamp submetido_em\n        timestamp confirmado_em\n        int ledger_sequence\n    }\n\n    AUDITORIA_BLOCKCHAIN {\n        uuid id PK\n        uuid transacao_stellar_id FK\n        string evento\n        jsonb dados_transacao\n        string ip_origem\n        string user_agent\n        timestamp registrado_em\n    }\n\n    %% Detec\xe7\xe3o de Fraude\n    ANALISE_FRAUDE {\n        uuid id PK\n        uuid usuario_id FK\n        uuid transacao_stellar_id FK\n        decimal score_fraude "0-100"\n        enum classificacao "BAIXO, MEDIO, ALTO, CRITICO"\n        jsonb features_ml\n        string modelo_versao\n        boolean bloqueado\n        string motivo_bloqueio\n        timestamp analisado_em\n    }\n\n    ALERTA_FRAUDE {\n        uuid id PK\n        uuid analise_fraude_id FK\n        enum tipo_alerta "PADRAO_SUSPEITO, VALOR_ANOMALO, FREQUENCIA_ALTA, DISPOSITIVO_NOVO"\n        enum severidade "BAIXA, MEDIA, ALTA, CRITICA"\n        string descricao\n        jsonb detalhes\n        boolean resolvido\n        string resolucao\n        timestamp criado_em\n        timestamp resolvido_em\n    }\n\n    %% Recomenda\xe7\xf5es\n    RECOMENDACAO {\n        uuid id PK\n        uuid usuario_id FK\n        uuid solicitacao_credito_id FK\n        enum tipo "INVESTIMENTO, CREDITO, PRODUTO"\n        decimal score_recomendacao\n        string titulo\n        string descricao\n        jsonb parametros\n        boolean visualizado\n        boolean aceito\n        timestamp criado_em\n        timestamp expira_em\n    }\n\n    %% LGPD e Consentimentos\n    CONSENTIMENTO_LGPD {\n        uuid id PK\n        uuid usuario_id FK\n        enum tipo_consentimento "DADOS_PESSOAIS, CONSULTA_CREDITO, OPEN_FINANCE, MARKETING"\n        boolean consentido\n        string ip_consentimento\n        timestamp consentido_em\n        timestamp revogado_em\n        string finalidade\n    }\n\n    %% Integra\xe7\xf5es Externas\n    CONSULTA_SERASA {\n        uuid id PK\n        uuid usuario_id FK\n        int score_retornado\n        jsonb dados_completos\n        timestamp consultado_em\n        string protocolo_serasa\n    }\n\n    DADOS_OPEN_FINANCE {\n        uuid id PK\n        uuid usuario_id FK\n        string instituicao\n        jsonb contas\n        jsonb transacoes\n        jsonb investimentos\n        timestamp sincronizado_em\n        timestamp expira_em\n    }\n\n    TRANSACAO_PIX {\n        uuid id PK\n        uuid usuario_id FK\n        uuid transacao_stellar_id FK\n        string pix_id UK\n        decimal valor\n        enum tipo "ENTRADA, SAIDA"\n        string chave_pix\n        enum status "PENDENTE, CONCLUIDA, FALHA"\n        timestamp criado_em\n    }\n\n    %% Chat e Suporte\n    CONVERSA_CHAT {\n        uuid id PK\n        uuid usuario_id FK\n        string titulo\n        enum status "ABERTA, RESOLVIDA, FECHADA"\n        timestamp iniciado_em\n        timestamp atualizado_em\n    }\n\n    MENSAGEM_CHAT {\n        uuid id PK\n        uuid conversa_id FK\n        enum remetente "USUARIO, BOT, ATENDENTE"\n        text conteudo\n        jsonb metadados\n        boolean visualizado\n        timestamp enviado_em\n    }\n\n    %% Relacionamentos\n    USUARIO ||--o{ AUTENTICACAO : "tem"\n    USUARIO ||--o{ STELLAR_WALLET : "possui"\n    USUARIO ||--o| PERFIL_INVESTIDOR : "tem"\n    USUARIO ||--o| PERFIL_TOMADOR : "tem"\n    USUARIO ||--o{ SCORE_CREDITO : "possui"\n    USUARIO ||--o{ SOLICITACAO_CREDITO : "solicita"\n    USUARIO ||--o{ OFERTA_INVESTIMENTO : "oferece"\n    USUARIO ||--o{ TRANSACAO_STELLAR : "realiza origem"\n    USUARIO ||--o{ TRANSACAO_STELLAR : "recebe destino"\n    USUARIO ||--o{ ANALISE_FRAUDE : "analisado"\n    USUARIO ||--o{ RECOMENDACAO : "recebe"\n    USUARIO ||--o{ CONSENTIMENTO_LGPD : "consente"\n    USUARIO ||--o{ CONSULTA_SERASA : "consultado"\n    USUARIO ||--o{ DADOS_OPEN_FINANCE : "sincroniza"\n    USUARIO ||--o{ TRANSACAO_PIX : "realiza"\n    USUARIO ||--o{ CONVERSA_CHAT : "inicia"\n    \n    SCORE_CREDITO ||--o{ HISTORICO_SCORE : "possui"\n    \n    SOLICITACAO_CREDITO ||--o{ OFERTA_INVESTIMENTO : "recebe"\n    SOLICITACAO_CREDITO ||--o| CONTRATO : "gera"\n    SOLICITACAO_CREDITO ||--o{ RECOMENDACAO : "recomendado"\n    \n    OFERTA_INVESTIMENTO ||--o| CONTRATO : "origina"\n    \n    CONTRATO ||--o{ PARCELA : "possui"\n    \n    TRANSACAO_STELLAR ||--o| AUDITORIA_BLOCKCHAIN : "auditada"\n    TRANSACAO_STELLAR ||--o| ANALISE_FRAUDE : "analisada"\n    TRANSACAO_STELLAR ||--o| TRANSACAO_PIX : "relacionada"\n    \n    ANALISE_FRAUDE ||--o{ ALERTA_FRAUDE : "gera"\n    \n    CONVERSA_CHAT ||--o{ MENSAGEM_CHAT : "cont\xe9m"\n'})})]})}function m(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>s,x:()=>d});var i=a(6540);const o={},t=i.createContext(o);function s(n){const e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);