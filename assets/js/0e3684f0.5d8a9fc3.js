"use strict";(self.webpackChunkmithril=self.webpackChunkmithril||[]).push([[723],{385:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>l});const n=JSON.parse('{"id":"desenvolvimento/banco-de-dados","title":"Banco de Dados","description":"Este documento descreve o desenho l\xf3gico e as principais entidades do banco de dados do projeto, al\xe9m de \xedndices, views, fun\xe7\xf5es, triggers, sementes iniciais e orienta\xe7\xf5es operacionais.","source":"@site/docs/desenvolvimento/banco-de-dados.md","sourceDirName":"desenvolvimento","slug":"/desenvolvimento/banco-de-dados","permalink":"/Mithril/docs/desenvolvimento/banco-de-dados","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/desenvolvimento/banco-de-dados.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Banco de Dados","label":"Banco de Dados"},"sidebar":"tutorialSidebar","previous":{"title":"Implementa\xe7\xe3o de Blockchain Stellar","permalink":"/Mithril/docs/desenvolvimento/blockchain"},"next":{"title":"Back-End","permalink":"/Mithril/docs/desenvolvimento/backend"}}');var c=i(4848),o=i(8453);const d={sidebar_position:3,title:"Banco de Dados",label:"Banco de Dados"},r=void 0,a={},l=[{value:"Vis\xe3o geral",id:"vis\xe3o-geral",level:3},{value:"Diagrama",id:"diagrama",level:3},{value:"Extens\xf5es e tipos",id:"extens\xf5es-e-tipos",level:3},{value:"Principais tabelas (por dom\xednio)",id:"principais-tabelas-por-dom\xednio",level:3},{value:"Usu\xe1rios e autentica\xe7\xe3o",id:"usu\xe1rios-e-autentica\xe7\xe3o",level:4},{value:"Perfis e score",id:"perfis-e-score",level:4},{value:"Cr\xe9dito e investimento",id:"cr\xe9dito-e-investimento",level:4},{value:"Transa\xe7\xf5es e financeiro",id:"transa\xe7\xf5es-e-financeiro",level:4},{value:"Fraude e risco operacional",id:"fraude-e-risco-operacional",level:4},{value:"Recomenda\xe7\xf5es",id:"recomenda\xe7\xf5es",level:4},{value:"LGPD e consentimentos",id:"lgpd-e-consentimentos",level:4},{value:"Integra\xe7\xf5es externas",id:"integra\xe7\xf5es-externas",level:4},{value:"Chat e suporte",id:"chat-e-suporte",level:4},{value:"Relacionamentos (alto n\xedvel)",id:"relacionamentos-alto-n\xedvel",level:3},{value:"\xcdndices",id:"\xedndices",level:3},{value:"Views",id:"views",level:3},{value:"Fun\xe7\xf5es e triggers",id:"fun\xe7\xf5es-e-triggers",level:3},{value:"Seeds (dados iniciais)",id:"seeds-dados-iniciais",level:3},{value:"Conven\xe7\xf5es e pol\xedticas",id:"conven\xe7\xf5es-e-pol\xedticas",level:3},{value:"Refer\xeancias",id:"refer\xeancias",level:3}];function t(e){const s={code:"code",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(s.p,{children:"Este documento descreve o desenho l\xf3gico e as principais entidades do banco de dados do projeto, al\xe9m de \xedndices, views, fun\xe7\xf5es, triggers, sementes iniciais e orienta\xe7\xf5es operacionais."}),"\n",(0,c.jsx)(s.h3,{id:"vis\xe3o-geral",children:"Vis\xe3o geral"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"SGBD"}),": PostgreSQL 14+ (com extens\xf5es ",(0,c.jsx)(s.code,{children:"uuid-ossp"})," e ",(0,c.jsx)(s.code,{children:"pgcrypto"}),")."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Hospedagem"}),": Supabase (PostgreSQL gerenciado)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Script fonte"}),": ",(0,c.jsx)(s.code,{children:"src/backend/banco-dados/db.sql"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Dom\xednios"}),": usu\xe1rios/autentica\xe7\xe3o, perfis e score, cr\xe9dito e investimento, transa\xe7\xf5es on-chain (Stellar), fraude, recomenda\xe7\xf5es, LGPD/consentimentos, integra\xe7\xf5es externas, chat/suporte."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.strong,{children:"Identificadores"}),": todas as tabelas utilizam ",(0,c.jsx)(s.code,{children:"UUID"})," como chave prim\xe1ria."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"diagrama",children:"Diagrama"}),"\n",(0,c.jsx)(s.p,{children:"Para vis\xe3o macro de entidades e relacionamentos, consulte o diagrama:"}),"\n",(0,c.jsx)(s.p,{children:(0,c.jsx)(s.img,{alt:"Diagrama de Banco de Dados",src:i(2538).A+"",width:"10576",height:"4778"})}),"\n",(0,c.jsx)(s.h3,{id:"extens\xf5es-e-tipos",children:"Extens\xf5es e tipos"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["Extens\xf5es: ",(0,c.jsx)(s.code,{children:"uuid-ossp"}),", ",(0,c.jsx)(s.code,{children:"pgcrypto"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:["Enums principais: ",(0,c.jsx)(s.code,{children:"perfil_risco_enum"}),", ",(0,c.jsx)(s.code,{children:"ocupacao_enum"}),", ",(0,c.jsx)(s.code,{children:"classificacao_score_enum"}),", ",(0,c.jsx)(s.code,{children:"finalidade_credito_enum"}),", ",(0,c.jsx)(s.code,{children:"status_solicitacao_enum"}),", ",(0,c.jsx)(s.code,{children:"status_oferta_enum"}),", ",(0,c.jsx)(s.code,{children:"status_contrato_enum"}),", ",(0,c.jsx)(s.code,{children:"status_parcela_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_transacao_enum"}),", ",(0,c.jsx)(s.code,{children:"status_transacao_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_movimentacao_enum"}),", ",(0,c.jsx)(s.code,{children:"wallet_type_enum"}),", ",(0,c.jsx)(s.code,{children:"classificacao_fraude_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_alerta_enum"}),", ",(0,c.jsx)(s.code,{children:"severidade_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_recomendacao_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_consentimento_enum"}),", ",(0,c.jsx)(s.code,{children:"tipo_pix_enum"}),", ",(0,c.jsx)(s.code,{children:"status_pix_enum"}),", ",(0,c.jsx)(s.code,{children:"status_chat_enum"}),", ",(0,c.jsx)(s.code,{children:"remetente_enum"}),", ",(0,c.jsx)(s.code,{children:"rede_blockchain_enum"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"principais-tabelas-por-dom\xednio",children:"Principais tabelas (por dom\xednio)"}),"\n",(0,c.jsx)(s.h4,{id:"usu\xe1rios-e-autentica\xe7\xe3o",children:"Usu\xe1rios e autentica\xe7\xe3o"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"usuario"}),": dados cadastrais, status e timestamps; \xedndices em ",(0,c.jsx)(s.code,{children:"cpf"}),", ",(0,c.jsx)(s.code,{children:"email"}),", ",(0,c.jsx)(s.code,{children:"ativo"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"autenticacao"}),": credenciais/biometria por ",(0,c.jsx)(s.code,{children:"usuario_id"}),", controle de bloqueio e tentativas; \xedndice por ",(0,c.jsx)(s.code,{children:"usuario_id"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"stellar_wallet"}),": chaves p\xfablicas Stellar vinculadas ao usu\xe1rio; flags ",(0,c.jsx)(s.code,{children:"principal"})," e ",(0,c.jsx)(s.code,{children:"wallet_type"}),"; \xedndices por ",(0,c.jsx)(s.code,{children:"usuario_id"})," e ",(0,c.jsx)(s.code,{children:"public_key"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"perfis-e-score",children:"Perfis e score"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"perfil_investidor"}),": saldo, total investido, retorno e ",(0,c.jsx)(s.code,{children:"perfil_risco"})," (1\u20131 com ",(0,c.jsx)(s.code,{children:"usuario"}),")."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"perfil_tomador"}),": renda, ",(0,c.jsx)(s.code,{children:"ocupacao"}),", empresa, limites (1\u20131 com ",(0,c.jsx)(s.code,{children:"usuario"}),")."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"score_credito"}),": scores internos/externos, ",(0,c.jsx)(s.code,{children:"classificacao"}),", validade; hist\xf3rico em ",(0,c.jsx)(s.code,{children:"historico_score"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"score_investidor"}),": avalia\xe7\xe3o de investidor por ",(0,c.jsx)(s.code,{children:"usuario_id"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"historico_score"}),": trilha de altera\xe7\xf5es para ",(0,c.jsx)(s.code,{children:"score_credito"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"cr\xe9dito-e-investimento",children:"Cr\xe9dito e investimento"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"solicitacao_credito"}),": pedido do tomador com ",(0,c.jsx)(s.code,{children:"finalidade"}),", ",(0,c.jsx)(s.code,{children:"prazo_meses"}),", valor e ",(0,c.jsx)(s.code,{children:"analise_ia"}),"; status indexado."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"oferta_investimento"}),": ofertas de investidores para uma solicita\xe7\xe3o com taxa e validade; status indexado."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"smart_contract"}),": metadados de contratos implantados em Stellar (rede, endere\xe7o, wasm/hash)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"contrato"}),": v\xednculo tomador\u2013investidor\u2013solicita\xe7\xe3o\u2013oferta, termos financeiros, ",(0,c.jsx)(s.code,{children:"status"})," e refer\xeancia opcional a ",(0,c.jsx)(s.code,{children:"smart_contract"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"parcela"}),": amortiza\xe7\xe3o por contrato com valores, ",(0,c.jsx)(s.code,{children:"data_vencimento"}),", ",(0,c.jsx)(s.code,{children:"status"})," e controle de multas/juros; ",(0,c.jsx)(s.code,{children:"UNIQUE(contrato_id, numero_parcela)"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"transa\xe7\xf5es-e-financeiro",children:"Transa\xe7\xf5es e financeiro"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"transacao_stellar"}),": registro de opera\xe7\xf5es on-chain (hash, contas, valor, ",(0,c.jsx)(s.code,{children:"tipo"}),", ",(0,c.jsx)(s.code,{children:"status"}),", ",(0,c.jsx)(s.code,{children:"ledger_sequence"}),")."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"fee_config"}),": tabela de configura\xe7\xe3o de taxas por ",(0,c.jsx)(s.code,{children:"tipo"})," (percentual e/ou valor fixo)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"fundo_inadimplencia"}),": saldo e movimenta\xe7\xe3o agregada do fundo."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"movimentacao_financeira"}),": movimenta\xe7\xf5es off-chain por ",(0,c.jsx)(s.code,{children:"usuario_id"})," e ",(0,c.jsx)(s.code,{children:"tipo"})," (dep\xf3sito, investimento, rendimento, etc.)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"conversao_cambial"}),": execu\xe7\xf5es com par de moeda, taxa e v\xednculos a transa\xe7\xf5es Stellar."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"auditoria_blockchain"}),": eventos e metadados de auditoria vinculados a ",(0,c.jsx)(s.code,{children:"transacao_stellar"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"fraude-e-risco-operacional",children:"Fraude e risco operacional"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"analise_fraude"}),": score/classifica\xe7\xe3o, features de ML, bloqueio e motivo."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"alerta_fraude"}),": alertas com ",(0,c.jsx)(s.code,{children:"tipo_alerta"}),", ",(0,c.jsx)(s.code,{children:"severidade"}),", detalhes e resolu\xe7\xe3o."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"recomenda\xe7\xf5es",children:"Recomenda\xe7\xf5es"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"recomendacao"}),": recomenda\xe7\xf5es por ",(0,c.jsx)(s.code,{children:"usuario_id"})," e ",(0,c.jsx)(s.code,{children:"tipo"}),", com ",(0,c.jsx)(s.code,{children:"score_recomendacao"}),", par\xe2metros e flags de visualiza\xe7\xe3o/aceite."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"lgpd-e-consentimentos",children:"LGPD e consentimentos"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"consentimento_lgpd"}),": consentimentos por ",(0,c.jsx)(s.code,{children:"tipo_consentimento"}),", ",(0,c.jsx)(s.code,{children:"ip_consentimento"}),", timestamps de concess\xe3o/revoga\xe7\xe3o e finalidade."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"integra\xe7\xf5es-externas",children:"Integra\xe7\xf5es externas"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"consulta_serasa"}),": resultado bruto e score retornado, com protocolo."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"dados_open_finance"}),": contas, transa\xe7\xf5es e investimentos agregados por institui\xe7\xe3o."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"transacao_pix"}),": lan\xe7amento PIX (entrada/sa\xedda), chave, valor e ",(0,c.jsx)(s.code,{children:"status"}),"."]}),"\n"]}),"\n",(0,c.jsx)(s.h4,{id:"chat-e-suporte",children:"Chat e suporte"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"conversa_chat"}),": sess\xf5es com ",(0,c.jsx)(s.code,{children:"status"})," e timestamps; trigger de atualiza\xe7\xe3o autom\xe1tica."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"mensagem_chat"}),": mensagens por conversa com ",(0,c.jsx)(s.code,{children:"remetente"})," e metadados."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"relacionamentos-alto-n\xedvel",children:"Relacionamentos (alto n\xedvel)"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"autenticacao.usuario_id \u2192 usuario.id"})," (1\u20131)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"stellar_wallet.usuario_id \u2192 usuario.id"})," (1\u2013N, uma carteira pode ser principal)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"perfil_investidor.usuario_id"})," e ",(0,c.jsx)(s.code,{children:"perfil_tomador.usuario_id"})," (1\u20131 com ",(0,c.jsx)(s.code,{children:"usuario"}),")."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"score_*"})," e ",(0,c.jsx)(s.code,{children:"historico_score"})," dependem de ",(0,c.jsx)(s.code,{children:"usuario"}),"/",(0,c.jsx)(s.code,{children:"score_credito"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"solicitacao_credito.tomador_id \u2192 usuario.id"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"oferta_investimento.(solicitacao_credito_id, investidor_id)"})," referenciam ",(0,c.jsx)(s.code,{children:"solicitacao_credito"})," e ",(0,c.jsx)(s.code,{children:"usuario"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"contrato"})," referencia ",(0,c.jsx)(s.code,{children:"solicitacao_credito"}),", ",(0,c.jsx)(s.code,{children:"oferta_investimento"}),", ",(0,c.jsx)(s.code,{children:"usuario"})," (tomador e investidor) e opcionalmente ",(0,c.jsx)(s.code,{children:"smart_contract"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"parcela.contrato_id \u2192 contrato.id"})," (1\u2013N)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"transacao_stellar"})," pode referenciar ",(0,c.jsx)(s.code,{children:"usuario"})," (origem/destino) e ",(0,c.jsx)(s.code,{children:"smart_contract"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"analise_fraude"}),"/",(0,c.jsx)(s.code,{children:"alerta_fraude"})," vinculam-se a ",(0,c.jsx)(s.code,{children:"usuario"})," e ",(0,c.jsx)(s.code,{children:"transacao_stellar"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"recomendacao"})," pode referenciar ",(0,c.jsx)(s.code,{children:"solicitacao_credito"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"conversas/mensagens"})," vinculam usu\xe1rio e conversa."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"\xedndices",children:"\xcdndices"}),"\n",(0,c.jsxs)(s.p,{children:["H\xe1 \xedndices em campos-chave de busca e filtragem: documentos (",(0,c.jsx)(s.code,{children:"cpf"}),", ",(0,c.jsx)(s.code,{children:"email"}),"), flags (",(0,c.jsx)(s.code,{children:"ativo"}),", ",(0,c.jsx)(s.code,{children:"status"}),"), chaves estrangeiras frequentes (por exemplo, ",(0,c.jsx)(s.code,{children:"usuario_id"}),", ",(0,c.jsx)(s.code,{children:"contrato_id"}),'), atributos de neg\xf3cio (datas de vencimento, tipos e classifica\xe7\xf5es), al\xe9m de \xedndices espec\xedficos para auditoria e integra\xe7\xf5es. Ver a se\xe7\xe3o "\xcdNDICES" no ',(0,c.jsx)(s.code,{children:"db.sql"})," para a lista completa."]}),"\n",(0,c.jsx)(s.h3,{id:"views",children:"Views"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"vw_usuario_completo"}),": consolida dados de ",(0,c.jsx)(s.code,{children:"usuario"}),", perfis e score vigente."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"vw_contratos_ativos"}),": resumo de contratos ativos com contagem de parcelas pagas/atrasadas."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"vw_parcelas_vencendo"}),": parcelas pendentes no horizonte de 7 dias (dados do tomador)."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"fun\xe7\xf5es-e-triggers",children:"Fun\xe7\xf5es e triggers"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"calcular_parcelas(valor_total, taxa_juros, prazo_meses)"}),": retorna valor de parcela calculado pela f\xf3rmula de price."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"atualizar_timestamp()"}),": trigger para manter ",(0,c.jsx)(s.code,{children:"atualizado_em"})," em entidades selecionadas."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"atualizar_saldo_investidor()"}),": trigger p\xf3s-inser\xe7\xe3o em ",(0,c.jsx)(s.code,{children:"movimentacao_financeira"})," para ajuste de saldo/retorno."]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Triggers definidos para: ",(0,c.jsx)(s.code,{children:"usuario"}),", ",(0,c.jsx)(s.code,{children:"perfil_investidor"}),", ",(0,c.jsx)(s.code,{children:"perfil_tomador"}),", ",(0,c.jsx)(s.code,{children:"conversa_chat"})," e ",(0,c.jsx)(s.code,{children:"movimentacao_financeira"})," (via fun\xe7\xe3o espec\xedfica)."]}),"\n",(0,c.jsx)(s.h3,{id:"seeds-dados-iniciais",children:"Seeds (dados iniciais)"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"fee_config"}),": configura\xe7\xf5es iniciais (MITHRIL, FUNDO_INADIMPLENCIA, PIX, CAMBIAL)."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"fundo_inadimplencia"}),": registro inicial com saldos zerados."]}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"conven\xe7\xf5es-e-pol\xedticas",children:"Conven\xe7\xf5es e pol\xedticas"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["Chaves prim\xe1rias ",(0,c.jsx)(s.code,{children:"UUID"})," geradas por ",(0,c.jsx)(s.code,{children:"uuid_generate_v4()"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:[(0,c.jsx)(s.code,{children:"ON DELETE CASCADE"})," em v\xednculos que exigem limpeza consistente (por exemplo, ",(0,c.jsx)(s.code,{children:"autenticacao"}),", ",(0,c.jsx)(s.code,{children:"parcela"}),", mensagens de chat, etc.)."]}),"\n",(0,c.jsxs)(s.li,{children:["Timestamps padronizados: ",(0,c.jsx)(s.code,{children:"criado_em"}),", ",(0,c.jsx)(s.code,{children:"atualizado_em"}),", datas de eventos espec\xedficas por dom\xednio."]}),"\n",(0,c.jsx)(s.li,{children:"Enum para estados de neg\xf3cio, evitando valores m\xe1gicos."}),"\n"]}),"\n",(0,c.jsx)(s.h3,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,c.jsxs)(s.ul,{children:["\n",(0,c.jsxs)(s.li,{children:["Script completo: ",(0,c.jsx)(s.code,{children:"src/backend/banco-dados/db.sql"}),"."]}),"\n",(0,c.jsxs)(s.li,{children:["Diagrama: ",(0,c.jsx)(s.code,{children:"/img/db.svg"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(s.p,{children:["Em caso de diverg\xeancias, o ",(0,c.jsx)(s.code,{children:"db.sql"})," \xe9 a refer\xeancia principal."]})]})}function h(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,c.jsx)(s,{...e,children:(0,c.jsx)(t,{...e})}):t(e)}},2538:(e,s,i)=>{i.d(s,{A:()=>n});const n=i.p+"assets/images/db-9efa9e3d57264c14bb544eb927802490.svg"},8453:(e,s,i)=>{i.d(s,{R:()=>d,x:()=>r});var n=i(6540);const c={},o=n.createContext(c);function d(e){const s=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);